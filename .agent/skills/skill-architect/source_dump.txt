# ==================================================
# Path: /home/steve/Documents/KLTN/.agent/skills/skill-architect
# Detected tech: python
# ==================================================

## DIRECTORY STRUCTURE
```
skill-architect/
â”œâ”€â”€ knowledge/
â”‚   â”œâ”€â”€ architect.md
â”‚   â””â”€â”€ visualization-guidelines.md
â”œâ”€â”€ loop/
â”‚   â””â”€â”€ design-checklist.md
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ init_context.py
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ build-log.md.template
â”‚   â”œâ”€â”€ design.md.template
â”‚   â””â”€â”€ todo.md.template
â””â”€â”€ SKILL.md
```

## FILE CONTENTS

### SKILL.md
```md
---
name: skill-architect
description: 'Senior Architect thiet ke kien truc Agent Skill moi. Kich hoat khi user noi: "thiet ke skill", "ve design.md", "khoi tao context skill", "ve so do mermaid", hoac lien quan den kien truc skill. Su dung de phan tich yeu cau (3 Pillars/7 Zones) va tao ban thiet ke design.md.'
---
# Skill Architect

Act as a **Senior Skill Architect**. Analyze user requirements for building a new Agent Skill and produce a complete architecture design document at `.skill-context/{skill-name}/design.md`.

## ğŸ¯ Mission & Value
Chuyen gia phan tich va thiet ke cac Agent Skin co cau truc, dam bao tinh nhat quan, kha nang bao tri va hieu suat cao thong qua viec ap dung Framework *3 Pillars & 7 Zones*.

## âš¡ Triggers (Kich hoat)
Skill nay tu dong duoc goi khi user co cac yeu cau sau:
- "Thiet ke cho toi mot skill ve [ten_skill]"
- "Ve so do kien truc cho agent skill"
- "Tao file design.md theo kien truc Master Skill"
- "Phan tich yeu cau xay dung bo skill moi"

## ğŸ—ï¸ Contributing Components (Thanh phan dong gop)
GÃ³i skill nÃ y bao gá»“m cÃ¡c thÃ nh pháº§n hiá»‡p Ä‘á»“ng Ä‘á»ƒ Ä‘áº¡t Ä‘Æ°á»£c káº¿t quáº£:
- **`knowledge/architect.md`**: "Bá»™ nÃ£o" - Chá»©a framework kien truc cot loi (3 Pillars, 7 Zones).
- **`knowledge/visualization-guidelines.md`**: "ÄÃ´i máº¯t" - Quy chuáº©n ve sÆ¡ Ä‘á»“ Mermaid Ä‘á»ƒ cá»¥ thá»ƒ hÃ³a Ã½ tÆ°á»Ÿng.
- **`scripts/init_context.py`**: "BÃ n tay" - Tá»± Ä‘á»™ng hÃ³a viá»‡c táº¡o mÃ´i trÆ°á»ng vÃ  file máº«u.
- **`templates/design.md.template`**: "KhuÃ´n máº«u" - Äáº£m báº£o output luÃ´n Ä‘áº¡t chuáº©n 10 sections.

## ğŸš€ Mandatory Boot Sequence
1.  **Read Core Knowledge**: Read `knowledge/architect.md`.
2.  **Initialize Context**: Run `scripts/init_context.py {skill-name}` based on user input.
3.  **Start Phase 1**.

## ğŸ“ Progressive Writing Rule
**âš ï¸ CRITICAL**: Write results to `design.md` **immediately after each phase is confirmed**.

| After Phase | Update `design.md` Sections |
| ----------- | --------------------------- |
| 1 Confirmed | Â§1 Problem Statement, Â§10 Metadata |
| 2 Confirmed | Â§2 Capability Map, Â§3 Zone Mapping, Â§8 Risks |
| 3 Confirmed | Â§4, Â§5, Â§6, Â§7, Â§9 + Status Update |

## ğŸ•¹ï¸ Workflow Phases

### Phase 1: Collect (Thu thap)
- Identify **Pain Point**, **User & Context**, and **Expected Output**.
- Present a brief summary and wait for confirmation.

### Phase 2: Analyze (Phan tich)
- Map requirements to **3 Pillars** (Knowledge, Process, Guardrails).
- Map requirements to **7 Zones** (Table format).
- Present analysis and wait for confirmation.

### Phase 3: Design & Output (Thiet ke)
- **Reference**: Read `knowledge/visualization-guidelines.md`.
- **Create Diagrams First**: Mindmap (Structure), Sequence (Flow), Flowchart (Workflow).
- **Finalize**: Update `design.md` with diagrams and strategy.

## ğŸ“‹ Output Management
Tat ca du lieu duoc luu tai `.skill-context/{skill-name}/design.md`. File nay phai tuan thu day du 10 sections nhu trong template.

## ğŸ›¡ï¸ Guardrails
- **No Code**: Only design. Do not implement code scripts.
- **Gate Checks**: Each phase MUST end with an interaction point.
- **Diagrams First**: Minimum 3 Mermaid diagrams required.
- **No Guessing**: Ask clarifying questions if confidence < 70%.

## ğŸ”— Related Skills
- `skill-planner`: Ke hoach thuc thi (todo.md).
- `skill-builder`: Trien khai code thuc te.

```

### loop/design-checklist.md
```md
# Design Quality Checklist

> Skill Architect sá»­ dá»¥ng checklist nÃ y Ä‘á»ƒ kiá»ƒm tra cháº¥t lÆ°á»£ng báº£n thiáº¿t káº¿
> trÆ°á»›c khi ghi vÃ o `.skill-context/{skill-name}/design.md`.

---

## Structure Check

- [ ] File design.md cÃ³ Ä‘á»§ 10 sections (Problem Statement â†’ Metadata)
- [ ] CÃ³ Ã­t nháº¥t 2 sÆ¡ Ä‘á»“ Mermaid (Folder Structure + Execution Flow)
- [ ] Mermaid syntax há»£p lá»‡ (khÃ´ng lá»—i render)

## Content Check

- [ ] Problem Statement rÃµ rÃ ng: ai gáº·p váº¥n Ä‘á», váº¥n Ä‘á» gÃ¬, táº¡i sao cáº§n skill
- [ ] Capability Map phá»§ Ä‘á»§ 3 Trá»¥ cá»™t (Knowledge, Process, Guardrails)
- [ ] Zone Mapping xÃ¡c Ä‘á»‹nh rÃµ tá»«ng Zone cáº§n gÃ¬ (hoáº·c ghi "KhÃ´ng cáº§n")
- [ ] Folder Structure pháº£n Ã¡nh Ä‘Ãºng cÃ¡c Zone Ä‘Ã£ map
- [ ] Execution Flow thá»ƒ hiá»‡n Ä‘Ãºng workflow logic vá»›i interaction points
- [ ] Interaction Points liá»‡t kÃª Ã­t nháº¥t 1 Ä‘iá»ƒm dá»«ng tÆ°Æ¡ng tÃ¡c

## Framework Compliance

- [ ] Thiáº¿t káº¿ dá»±a trÃªn architect.md (3 Trá»¥ cá»™t + 7 Zones)
- [ ] CÃ³ Progressive Disclosure Plan (Tier 1 mandatory, Tier 2 conditional)
- [ ] Risks & Blind Spots khÃ´ng Ä‘á»ƒ trá»‘ng
- [ ] Open Questions Ä‘Æ°á»£c liá»‡t kÃª (hoáº·c ghi "KhÃ´ng cÃ³")

## Process Check

- [ ] Phase 1 (Collect) Ä‘Ã£ hoÃ n táº¥t â€” user Ä‘Ã£ confirm requirements
- [ ] Phase 2 (Analyze) Ä‘Ã£ hoÃ n táº¥t â€” user Ä‘Ã£ confirm analysis
- [ ] Phase 3 (Design) Ä‘Ã£ hoÃ n táº¥t â€” user Ä‘Ã£ confirm design
- [ ] init_context.py Ä‘Ã£ cháº¡y thÃ nh cÃ´ng trÆ°á»›c khi ghi file

## Final

- [ ] User Ä‘Ã£ xÃ¡c nháº­n báº£n thiáº¿t káº¿ cuá»‘i cÃ¹ng
- [ ] File Ä‘Ã£ ghi vÃ o `.skill-context/{skill-name}/design.md`

```

### knowledge/architect.md
```md
# AGENT SKILL FRAMEWORK - TÃ€I LIá»†U KIáº¾N TRÃšC

================================================================================
                        PHáº¦N 1: Tá»”NG QUAN KIáº¾N TRÃšC
================================================================================

## 1.1. MÃ´ hÃ¬nh Meta-Skill Framework

MÃ´ hÃ¬nh nÃ y Ä‘á»‹nh nghÄ©a cÃ¡ch tiáº¿p cáº­n tá»•ng thá»ƒ Ä‘á»ƒ xÃ¢y dá»±ng má»™t bá»™ Agent Skill
cÃ³ cáº¥u trÃºc, logic vÃ  kháº£ nÄƒng kiá»ƒm soÃ¡t cháº¥t lÆ°á»£ng.

```mermaid
graph TD
    subgraph MetaSkillFramework [MÃ” HÃŒNH KIá»‚M CÃCH - META-SKILL FRAMEWORK]
        P1[PHA 1: NHáº¬N DIá»†N<br/>Input/Output] --> P2[PHA 2: CHIáº¾N LÆ¯á»¢C<br/>Checklist/Plan]
        P2 --> P3[PHA 3: THá»°C THI<br/>Research/Action]
        
        P1 --> D1[Dá»¯ liá»‡u Gá»‘c]
        P2 --> D2[Quy trÃ¬nh Chuáº©n]
        P3 --> D3[TÆ°Æ¡ng tÃ¡c & Tháº©m Ä‘á»‹nh]
        
        D1 --> LC[VÃ’NG Láº¶P KIá»‚M SOÃT<br/>Verify/Fix/Loop]
        D2 --> LC
        D3 --> LC
    end

    style MetaSkillFramework fill:#f9f9f9,stroke:#333,stroke-width:2px
    style LC fill:#e1f5fe,stroke:#01579b
```


## 1.2. Kiáº¿n trÃºc "NgÃ´i nhÃ " (Building Metaphor)

```mermaid
graph TD
    Outcome[MÃI NHÃ€: GIÃ TRá»Š Äáº¦U RA - Outcome<br/>- Sáº£n pháº©m hoÃ n thiá»‡n, chÃ­nh xÃ¡c, cÃ³ tháº©m má»¹<br/>- NgÆ°á»i dÃ¹ng hÃ i lÃ²ng vÃ  tin tÆ°á»Ÿng]
    
    subgraph Pillars [CÃC TRá»¤ Cá»˜T]
        T1[TRá»¤ 1: TRI THá»¨C<br/>Knowledge]
        T2[TRá»¤ 2: QUY TRÃŒNH<br/>Logic/Steps]
        T3[TRá»¤ 3: KIá»‚M SOÃT<br/>Guardrails]
    end
    
    Foundation[Ná»€N MÃ“NG: NGHIÃŠN Cá»¨U & PHÃ‚N TÃCH<br/>Input, Tools, Environment, User Pain-points]
    
    Foundation --> Pillars
    Pillars --> Outcome

    style Outcome fill:#e8f5e9,stroke:#2e7d32
    style Foundation fill:#fff3e0,stroke:#ef6c00
    style Pillars fill:#f3e5f5,stroke:#7b1fa2
```


================================================================================
                  PHáº¦N 2: CÃC THÃ€NH PHáº¦N KIáº¾N TRÃšC (ZONES)
================================================================================

## 2.1. Cáº¥u trÃºc thÆ° má»¥c chuáº©n

```mermaid
mindmap
  root((your-skill-name))
    SKILL.md:::core
    .skillfish.json
    knowledge
      standards.md
      best-practices.md
      design-patterns.md
    scripts
      python
        analyzer.py
        validator.py
        generator.py
      javascript
        formatter.js
        mermaid-render.js
      bash
        scan-project.sh
        setup-env.sh
        export-diagram.sh
    templates
      sequence.mmd
      class.mmd
      activity.mmd
    data
      config.yaml
      schema.json
      seed-data.csv
    loop
      checklist.md
      tasks.md
      phase-verify.md
      final-verify.md
      test-cases
        login-flow.md
        order-flow.md
    assets
      icons
      fonts
      images

    classDef core fill:#f96
```


## 2.2. Chi tiáº¿t tá»«ng Zone

| ZONE | Má»¤C ÄÃCH | VÃ Dá»¤ Ná»˜I DUNG | KHI NÃ€O AI Äá»ŒC? |
| :--- | :--- | :--- | :--- |
| **SKILL.md (Core)** | Linh há»“n Ä‘iá»u khiá»ƒn | Persona, Steps, Guardrails | LUÃ”N LUÃ”N (khi skill Ä‘Æ°á»£c kÃ­ch hoáº¡t) |
| **knowledge/** | Tri thá»©c chuáº©n | UML rules, Design patterns | Khi cáº§n tham kháº£o quy táº¯c |
| **scripts/** | CÃ´ng cá»¥ tá»± Ä‘á»™ng hÃ³a | Python analyzer, Bash generator | Khi cáº§n thá»±c thi logic phá»©c táº¡p |
| **templates/** | Máº«u Ä‘áº§u ra | Mermaid templates, Code stubs | Khi cáº§n táº¡o output chuáº©n |
| **data/** | Cáº¥u hÃ¬nh & dá»¯ liá»‡u cá»©ng | YAML config, JSON schema | Khi cáº§n Ä‘á»c cáº¥u hÃ¬nh cá»‘ Ä‘á»‹nh |
| **loop/** | Kiá»ƒm soÃ¡t cháº¥t lÆ°á»£ng | Checklist, Tasks, Test cases | SAU má»—i phase Ä‘á»ƒ tá»± kiá»ƒm tra |
| **assets/** | TÃ i nguyÃªn tÄ©nh | Icons, Fonts, Images | Khi táº¡o output cÃ³ media |



================================================================================
                     PHáº¦N 3: WORKFLOW XÃ‚Y Dá»°NG SKILL
================================================================================

## 3.1. Quy trÃ¬nh 5 bÆ°á»›c

```mermaid
flowchart LR
    B1[BÆ¯á»šC 1: KHáº¢O SÃT<br/>Research] --> B2[BÆ¯á»šC 2: THIáº¾T Káº¾<br/>Design]
    B2 --> B3[BÆ¯á»šC 3: XÃ‚Y Dá»°NG<br/>Build]
    B3 --> B4[BÆ¯á»šC 4: KIá»‚M Äá»ŠNH<br/>Verify]
    B4 --> B5[BÆ¯á»šC 5: Báº¢O TRÃŒ<br/>Maintenance]

    subgraph Details [Chi tiáº¿t tá»«ng bÆ°á»›c]
        direction TB
        D1["- XÃ¡c Ä‘á»‹nh Pain Point<br/>- Thu tháº­p Use Cases<br/>- Liá»‡t kÃª Input/Output"]
        D2["- PhÃ¢n vÃ¹ng thÃ nh pháº§n<br/>- Váº½ sÆ¡ Ä‘á»“ kiáº¿n trÃºc<br/>- Äá»‹nh nghÄ©a luá»“ng lÃ m viá»‡c"]
        D3["- Táº¡o cáº¥u trÃºc thÆ° má»¥c<br/>- Náº¡p dá»¯ liá»‡u vÃ o cÃ¡c vÃ¹ng<br/>- Viáº¿t SKILL.md"]
        D4["- Cháº¡y Test Cases<br/>- Verify Checklist<br/>- Rollback náº¿u Fail"]
        D5["- Feedback Loop<br/>- Version Control<br/>- Cáº­p nháº­t Skill"]
    end

    B1 -.-> D1
    B2 -.-> D2
    B3 -.-> D3
    B4 -.-> D4
    B5 -.-> D5

    style B1 fill:#f9f,stroke:#333
    style B5 fill:#0ff,stroke:#333
```


## 3.2. Chi tiáº¿t tá»«ng bÆ°á»›c

### BÆ°á»›c 1: Kháº£o sÃ¡t (Research & Discovery)

    Má»¥c tiÃªu: Hiá»ƒu rÃµ "vÃ¹ng Ä‘áº¥t" mÃ¬nh Ä‘á»‹nh xÃ¢y.
    
    Viá»‡c cáº§n lÃ m:
    [1] XÃ¡c Ä‘á»‹nh Input: NgÆ°á»i dÃ¹ng sáº½ Ä‘Æ°a cÃ¡i gÃ¬? (RÃ¡c hay vÃ ng?)
    [2] XÃ¡c Ä‘á»‹nh Tools: AI sáº½ dÃ¹ng Terminal, Browser hay Library nÃ o?
    [3] TÃ¬m ra "Äiá»ƒm mÃ¹" cá»§a AI: AI thÆ°á»ng sai á»Ÿ Ä‘Ã¢u trong cÃ´ng viá»‡c nÃ y?

### BÆ°á»›c 2: Thiáº¿t káº¿ (System Design)

    Má»¥c tiÃªu: Táº¡o ra logic "tÆ°á»ng minh" cho AI.
    
    Viá»‡c cáº§n lÃ m:
    [1] XÃ¢y dá»±ng Quy trÃ¬nh logic (Flowchart): BÆ°á»›c A -> BÆ°á»›c B
    [2] XÃ¡c Ä‘á»‹nh Äiá»ƒm dá»«ng tÆ°Æ¡ng tÃ¡c: Khi nÃ o AI PHáº¢I há»i ngÆ°á»i dÃ¹ng?
    [3] Äá»‹nh nghÄ©a Äá»‹nh dáº¡ng Output: Mermaid, Markdown, hay Code?

### BÆ°á»›c 3: XÃ¢y dá»±ng (Build)

    Má»¥c tiÃªu: Viáº¿t file SKILL.md vÃ  náº¡p tÃ i nguyÃªn.
    
    Viá»‡c cáº§n lÃ m:
    [1] Persona: Äá»‹nh vá»‹ AI lÃ  Senior Architect hay Senior Coder
    [2] Phase-based Steps: Chia nhá» cÃ´ng viá»‡c thÃ nh cÃ¡c Pha
    [3] Táº¡o templates, scripts, knowledge files

### BÆ°á»›c 4: Kiá»ƒm Ä‘á»‹nh (Verify)

    Má»¥c tiÃªu: Äáº£m báº£o Skill hoáº¡t Ä‘á»™ng Ä‘Ãºng.
    
    Viá»‡c cáº§n lÃ m:
    [1] Cháº¡y Test Cases
    [2] Verify Checklist
    [3] Rollback náº¿u phÃ¡t hiá»‡n lá»—i

### BÆ°á»›c 5: Báº£o trÃ¬ (Maintenance)

    Má»¥c tiÃªu: Giá»¯ cho Skill khÃ´ng bá»‹ "lá»—i thá»i".
    
    Viá»‡c cáº§n lÃ m:
    [1] Feedback Loop: Ghi láº¡i chá»— AI lÃ m dá»Ÿ
    [2] Version Control: Cáº­p nháº­t khi mÃ´i trÆ°á»ng thay Ä‘á»•i


================================================================================
                   PHáº¦N 4: CÆ  CHáº¾ KIá»‚M SOÃT (LOOP/VERIFY)
================================================================================

## 4.1. Hai cháº¿ Ä‘á»™ kiá»ƒm soÃ¡t

```mermaid
flowchart TD
    subgraph LoopZone [VÃ™NG LOOP - KIá»‚M SOÃT CHáº¤T LÆ¯á»¢NG]
        direction TB
        Simple[SIMPLE MODE<br/>1 láº§n cuá»‘i]
        Phase[PHASE MODE<br/>Má»—i phase]
        
        SimpleCheck{Khi nÃ o dÃ¹ng?}
        PhaseCheck{Khi nÃ o dÃ¹ng?}
        
        SimpleFlow[Input -> Work -> Output<br/>-> VERIFY]
        PhaseFlow[Phase 1 -> V<br/>Phase 2 -> V<br/>Phase 3 -> V<br/>Final -> VV]

        Simple --> SimpleCheck
        Phase --> PhaseCheck
        
        SimpleCheck -->|YÃªu cáº§u Ä‘Æ¡n giáº£n| SimpleFlow
        PhaseCheck -->|YÃªu cáº§u phá»©c táº¡p| PhaseFlow
    end

    style Simple fill:#fff9c4,stroke:#fbc02d
    style Phase fill:#c8e6c9,stroke:#388e3c
```


## 4.2. Cáº¥u trÃºc thÆ° má»¥c loop/

```
loop/
+-- checklist.md            <-- Danh sÃ¡ch kiá»ƒm tra chung
+-- tasks.md                <-- CÃ´ng viá»‡c cáº§n hoÃ n thÃ nh
+-- phase-verify.md         <-- Checklist riÃªng cho tá»«ng Phase
+-- final-verify.md         <-- Checklist kiá»ƒm tra cuá»‘i cÃ¹ng
+-- test-cases/
    +-- login-flow.md
    +-- order-flow.md
```


================================================================================
                    PHáº¦N 5: VÃ™NG SCRIPTS (CÃ”NG Cá»¤)
================================================================================

## 5.1. Ba loáº¡i script

```mermaid
graph LR
    subgraph ScriptsZone [VÃ™NG SCRIPTS - CÃ”NG Cá»¤ THá»°C THI]
        direction TB
        Python[Python<br/>Xá»­ lÃ½ logic, phÃ¢n tÃ­ch text]
        JS[JavaScript<br/>Xá»­ lÃ½ frontend, JSON, DOM]
        Bash[Bash<br/>Lá»‡nh há»‡ thá»‘ng, file system]
        
        Python --- P1[analyzer.py<br/>validator.py<br/>generator.py]
        JS --- J1[formatter.js<br/>mermaid-render.js]
        Bash --- B1[scan-project.sh<br/>setup-env.sh<br/>export-diagram.sh]
    end

    style Python fill:#e3f2fd,stroke:#1e88e5
    style JS fill:#fffde7,stroke:#fdd835
    style Bash fill:#f5f5f5,stroke:#757575
```


## 5.2. Ma tráº­n chá»n script theo cÃ´ng viá»‡c

| LOáº I CÃ”NG VIá»†C | SCRIPT Æ¯U TIÃŠN |
| :--- | :--- |
| **PhÃ¢n tÃ­ch text, NLP** | Python |
| **Xá»­ lÃ½ JSON, format data** | JavaScript |
| **QuÃ©t thÆ° má»¥c, Ä‘á»c cáº¥u trÃºc** | Bash |
| **Validate syntax** | Python |
| **Render diagram** | JavaScript |
| **Táº¡o file, copy template** | Bash |
| **Gá»i API bÃªn ngoÃ i** | Python/JS |



================================================================================
               PHáº¦N 6: PROGRESSIVE DISCLOSURE (Náº P TÃ€I NGUYÃŠN)
================================================================================

## 6.1. Hai táº§ng náº¡p file

```mermaid
flowchart TD
    subgraph ProgressiveDisclosure [CÆ  CHáº¾ Náº P TÃ€I NGUYÃŠN]
        direction TB
        Mandatory[Táº¦NG 1: Báº®T BUá»˜C Äá»ŒC<br/>Mandatory Loading]
        Optional[Táº¦NG 2: Tá»° QUYáº¾T Äá»ŠNH<br/>Conditional Loading]
        
        Mandatory --- M1["- SKILL.md<br/>- knowledge/standards.md<br/>- loop/checklist.md"]
        Optional --- O1["- knowledge/design-patterns.md<br/>- templates/*.mmd<br/>- data/schema.json"]
        
        Mandatory -->|Sau khi Ä‘á»c xong| Optional
    end

    style Mandatory fill:#ffcdd2,stroke:#e53935
    style Optional fill:#c5cae9,stroke:#3f51b5
```



================================================================================
                  PHáº¦N 7: LUá»’NG HOáº T Äá»˜NG Cá»¦A AI AGENT
================================================================================

## 7.1. Execution Flow

```mermaid
sequenceDiagram
    participant U as USER
    participant A as AI AGENT
    participant K as Knowledge Zone
    participant S as Scripts Zone
    participant T as Templates Zone
    participant L as Loop Zone

    U->>A: Input "Váº½ sequence cho Login"
    A->>A: STEP 1: Äá»c SKILL.md (Persona & Steps)
    A->>A: STEP 2: PhÃ¢n tÃ­ch Input (Use Case)
    Note over A,U: [Interaction Point] Há»i náº¿u thiáº¿u thÃ´ng tin
    A->>K: STEP 3: Tham kháº£o standards.md, uml-rules.md
    A->>S: STEP 4: Cháº¡y analyzer.py (BÃ³c tÃ¡ch entities)
    A->>T: STEP 5: Ãp dá»¥ng seq.mmd lÃ m khung
    A->>A: STEP 6: Táº¡o Output (Mermaid code)
    A->>L: STEP 7: Tá»± kiá»ƒm tra vá»›i checklist.md
    alt Fail?
        L-->>A: Quay láº¡i Step tÆ°Æ¡ng á»©ng
    else Pass?
        A->>U: Tráº£ káº¿t quáº£ cuá»‘i cÃ¹ng
    end
```



================================================================================
                   PHáº¦N 8: KIáº¾N TRÃšC Tá»”NG Há»¢P (v2.0)
================================================================================

```mermaid
graph TD
    Skill((SKILL.md<br/>CORE))
    
    subgraph Tier1 [Táº¦NG 1: Báº®T BUá»˜C]
        K1[knowledge/standards]
        L1[loop/checklist]
    end
    
    subgraph Tier2 [Táº¦NG 2: Tá»° QUYáº¾T]
        S1[scripts/]
        T1[templates/]
        D1[data/]
        A1[assets/]
        K2[knowledge/patterns]
    end

    Skill --> Tier1
    Skill --> Tier2

    style Skill fill:#f96,stroke:#333,stroke-width:4px
    style Tier1 fill:#fff9c4,stroke:#fbc02d
    style Tier2 fill:#e1f5fe,stroke:#01579b
```



================================================================================
                            PHáº¦N 9: PHá»¤ Lá»¤C
================================================================================

## 9.1. NguyÃªn táº¯c viáº¿t SKILL.md

    [1] Imperative Form: LuÃ´n báº¯t Ä‘áº§u báº±ng Ä‘á»™ng tá»« máº¡nh
        VÃ­ dá»¥: "Analyze the input", "Generate the code"
        KHÃ”NG dÃ¹ng: "You should analyze"
    
    [2] Progressive Disclosure: Chá»‰ Ä‘á»ƒ nhá»¯ng gÃ¬ AI cáº§n lÃ m NGAY Láº¬P Tá»¨C
        trong SKILL.md. TÃ i liá»‡u tham kháº£o dÃ i Ä‘á»ƒ trong references/
    
    [3] Verified Steps: Má»—i giai Ä‘oáº¡n (Phase) pháº£i káº¿t thÃºc báº±ng:
        "Check the output against the checklist in loop/checklist.md"

## 9.2. Äiá»ƒm dá»«ng tÆ°Æ¡ng tÃ¡c (Interaction Points)

    AI PHáº¢I dá»«ng láº¡i vÃ  há»i ngÆ°á»i dÃ¹ng khi:
    [1] ThÃ´ng tin Ä‘áº§u vÃ o khÃ´ng Ä‘á»§ Ä‘á»ƒ xá»­ lÃ½
    [2] CÃ³ nhiá»u cÃ¡ch hiá»ƒu khÃ¡c nhau
    [3] Cáº§n xÃ¡c nháº­n trÆ°á»›c khi thá»±c hiá»‡n hÃ nh Ä‘á»™ng cÃ³ rá»§i ro
    [4] Confidence Score dÆ°á»›i 70%

## 9.3. CÆ¡ cháº¿ Rollback

    Náº¿u á»Ÿ Phase N phÃ¡t hiá»‡n lá»—i tá»« Phase M (M < N):
    [1] Ghi nháº­n lá»—i vÃ  nguyÃªn nhÃ¢n
    [2] ThÃ´ng bÃ¡o ngÆ°á»i dÃ¹ng vá» viá»‡c quay láº¡i
    [3] Quay láº¡i Phase M vÃ  sá»­a lá»—i
    [4] Tiáº¿p tá»¥c láº¡i tá»« Phase M

================================================================================
                               Káº¾T THÃšC TÃ€I LIá»†U
================================================================================
PhiÃªn báº£n: 2.0
NgÃ y táº¡o: 2026-02-09
TÃ¡c giáº£: VÅ© ThÆ°Æ¡ng Háº£i (vá»›i sá»± há»— trá»£ cá»§a AI Agent)
================================================================================

```

### knowledge/visualization-guidelines.md
```md
# Visualization & Diagram Guidelines

This guide defines how to create effective, concrete, and unambiguous architecture diagrams for Agent Skills. Use these when designing a new skill to ensure clarity for both humans and AI.

## Principle: "Show, then explain"

For each major concept, FIRST draw a diagram, THEN add a table or text that explains details the diagram cannot convey. Never replace a diagram with a table.

## Diagram Types & When to Use

| #  | Diagram Type       | Mermaid Syntax  | Use When                                          |
| -- | ------------------ | --------------- | ------------------------------------------------- |
| D1 | **Folder Structure** | `mindmap`     | ALWAYS â€” show the skill's directory tree           |
| D2 | **Execution Flow**   | `sequenceDiagram` | ALWAYS â€” show runtime interaction between participants |
| D3 | **Workflow Phases**  | `flowchart LR` | Skill has multi-phase workflow with clear stages   |
| D4 | **Relationship**     | `flowchart TD` | Skill connects to external systems or other skills |
| D5 | **Data Flow**        | `flowchart LR` | Skill transforms data through multiple stages      |

## Mermaid Skeletons

Use these as starting points. Adapt them to the specific skill being designed.

### D1 â€” Folder Structure (Mindmap)
```mermaid
mindmap
  root((skill-name))
    SKILL.md
      Persona
      Phases
      Guardrails
    knowledge
      domain-ref.md
    scripts
      tool.py
    templates
      output.md.template
    loop
      checklist.md
```

### D2 â€” Execution Flow (Sequence)
```mermaid
sequenceDiagram
    participant U as User
    participant S as Skill
    participant K as Knowledge
    participant L as Loop

    U->>S: Input
    S->>K: Read references
    S->>S: Process
    S->>L: Self-verify
    alt Pass
        S->>U: Output
    else Fail
        L-->>S: Retry
    end
```

### D3 â€” Workflow Phases (Flowchart)
```mermaid
flowchart LR
    P1[Phase 1] -->|gate| P2[Phase 2] -->|gate| P3[Phase 3]
    P1 -.-> I1[Interaction Point]
    P2 -.-> I2[Interaction Point]
    P3 -.-> I3[Output Gate]
```

### D4 â€” Relationship (Flowchart)
```mermaid
flowchart TD
    User -->|input| SkillA
    SkillA -->|output| ContextDir
    ContextDir -->|input| SkillB
    SkillB -->|output| FinalProduct
```

## Quality Checklist for Diagrams

- [ ] Each diagram has a clear title or is placed under a descriptive heading.
- [ ] Participants/nodes use short, readable labels.
- [ ] Decision points (alt/else, diamond nodes) are visible where logic branches.
- [ ] Interaction points with user are explicitly marked.
- [ ] Diagram renders correctly in standard Mermaid (no unsupported syntax).

```

### scripts/init_context.py
```py
#!/usr/bin/env python3
"""
init_context.py â€” Khoi tao cau truc thu muc .skill-context/{skill-name}/

Tao thu muc context va cac file template cho skill moi.
Safe-create policy: KHONG ghi de file da ton tai.

Usage:
    python init_context.py <skill-name>

Example:
    python init_context.py my-api-analyzer
"""

import sys
import os
import re
from pathlib import Path
from datetime import date


# ---------------------------------------------------------------------------
# Constants
# ---------------------------------------------------------------------------

KEBAB_CASE_PATTERN = re.compile(r"^[a-z][a-z0-9]*(-[a-z0-9]+)*$")
MAX_WALK_UP_LEVELS = 10

TEMPLATE_FILES = {
    "design.md": "design.md.template",
    "todo.md": "todo.md.template",
    "build-log.md": "build-log.md.template",
}

PLACEHOLDERS = {
    "{skill_name}": "",   # filled at runtime
    "{date}": "",         # filled at runtime
    "{author}": "Skill Architect",
}

FALLBACK_TEMPLATES = {
    "design.md": "# {skill_name} â€” Architecture Design\n\n> Generated: {date}\n\n## 1. Problem Statement\n\n## 2. Capability Map\n\n## 3. Zone Mapping\n\n## 4. Folder Structure\n\n## 5. Execution Flow\n\n## 6. Interaction Points\n\n## 7. Progressive Disclosure Plan\n\n## 8. Risks & Blind Spots\n\n## 9. Open Questions\n\n## 10. Metadata\n",
    "todo.md": "# {skill_name} â€” Implementation Plan\n\n> Generated: {date}\n\n## 1. Pre-requisites\n\n## 2. Phase Breakdown\n\n## 3. Knowledge & Resources Needed\n\n## 4. Definition of Done\n\n## 5. Notes\n",
    "build-log.md": "# {skill_name} â€” Build Log\n\n> Generated: {date}\n\n## 1. Build Session Log\n\n## 2. Files Created\n\n## 3. Decisions Made During Build\n\n## 4. Issues Encountered\n\n## 5. Final Status\n",
}


# ---------------------------------------------------------------------------
# Functions
# ---------------------------------------------------------------------------

def find_project_root(start_dir: Path) -> Path | None:
    """Walk up from start_dir to find the directory containing .agent/."""
    current = start_dir.resolve()
    for _ in range(MAX_WALK_UP_LEVELS):
        if (current / ".agent").is_dir():
            return current
        parent = current.parent
        if parent == current:
            break
        current = parent
    return None


def validate_skill_name(name: str) -> bool:
    """Check that skill name is valid kebab-case."""
    return bool(KEBAB_CASE_PATTERN.match(name))


def resolve_template_content(
    template_name: str, output_name: str, templates_dir: Path
) -> str:
    """Read template file or return fallback content."""
    template_path = templates_dir / template_name
    if template_path.is_file():
        return template_path.read_text(encoding="utf-8")

    print(f"  WARNING: Template '{template_name}' not found, using fallback")
    return FALLBACK_TEMPLATES.get(output_name, f"# {output_name}\n")


def replace_placeholders(content: str, replacements: dict[str, str]) -> str:
    """Replace all placeholders in content."""
    for placeholder, value in replacements.items():
        content = content.replace(placeholder, value)
    return content


def safe_create_file(filepath: Path, content: str) -> str:
    """Create file only if it does not exist. Return status string."""
    if filepath.exists():
        return "SKIPPED (already exists)"
    filepath.write_text(content, encoding="utf-8")
    return "CREATED"


def main() -> int:
    # --- Argument parsing ---
    if len(sys.argv) != 2:
        print("Usage: python init_context.py <skill-name>")
        print("  skill-name must be kebab-case (e.g., my-api-analyzer)")
        return 1

    skill_name = sys.argv[1]

    if not validate_skill_name(skill_name):
        print(f"Error: '{skill_name}' is not valid kebab-case.")
        print("  Use lowercase letters, numbers, and hyphens only.")
        print("  Example: my-api-analyzer, error-handler, sequence-diagram")
        return 1

    # --- Detect project root ---
    project_root = find_project_root(Path.cwd())
    if project_root is None:
        print("Error: Could not find .agent/ directory.")
        print("  Run this script from within the project directory.")
        return 1

    print(f"Project root: {project_root}")

    # --- Resolve paths ---
    context_root = project_root / ".skill-context"
    skill_context_dir = context_root / skill_name
    resources_dir = skill_context_dir / "resources"
    script_dir = Path(__file__).resolve().parent
    templates_dir = script_dir.parent / "templates"

    # --- Prepare placeholders ---
    replacements = {
        "{skill_name}": skill_name,
        "{date}": date.today().isoformat(),
        "{author}": "Skill Architect",
    }

    # --- Create directories ---
    context_root.mkdir(exist_ok=True)
    skill_context_dir.mkdir(exist_ok=True)
    resources_dir.mkdir(exist_ok=True)

    print(f"\nContext directory: {skill_context_dir}")
    print("-" * 50)

    # --- Create files from templates ---
    results = []
    for output_name, template_name in TEMPLATE_FILES.items():
        raw_content = resolve_template_content(
            template_name, output_name, templates_dir
        )
        content = replace_placeholders(raw_content, replacements)
        filepath = skill_context_dir / output_name
        status = safe_create_file(filepath, content)
        results.append((output_name, status))
        print(f"  {output_name:20s} â†’ {status}")

    # --- Summary ---
    created_count = sum(1 for _, s in results if s == "CREATED")
    skipped_count = sum(1 for _, s in results if "SKIPPED" in s)
    print(f"\nDone: {created_count} created, {skipped_count} skipped")
    print(f"Resources dir: {resources_dir}")

    return 0


if __name__ == "__main__":
    sys.exit(main())

```
