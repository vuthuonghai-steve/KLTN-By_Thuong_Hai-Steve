# sequence-design-analyst ‚Äî Architecture Design

> Generated by Skill Architect | Date: 2026-02-17
> Status: ÔøΩ COMPLETED

---

## 1. Problem Statement

Vi·ªác thi·∫øt k·∫ø Sequence Diagram (s∆° ƒë·ªì tu·∫ßn t·ª±) th∆∞·ªùng g·∫∑p kh√≥ khƒÉn do thi·∫øu s·ª± k·∫øt n·ªëi ch·∫∑t ch·∫Ω gi·ªØa y√™u c·∫ßu nghi·ªáp v·ª• th√¥ v√† logic th·ª±c thi trong codebase. C√°c s∆° ƒë·ªì do AI t·∫°o ra th∆∞·ªùng b·ªã thi·∫øu h·ª•t c√°c th√†nh ph·∫ßn lifeline (Actor, Service, DB) ho·∫∑c kh√¥ng m√¥ t·∫£ ch√≠nh x√°c th·ª© t·ª± message flow. Steve c·∫ßn m·ªôt gi·∫£i ph√°p chuy√™n bi·ªát c√≥ kh·∫£ nƒÉng t·ª± t·ªïng h·ª£p t·ª´ t√†i li·ªáu h∆∞·ªõng d·∫´n (context1.md), nghi√™n c·ª©u th·ª±c t·∫ø codebase v√† thi·∫øt k·∫ø s∆° ƒë·ªì chu·∫©n UML (Mermaid).

## 2. Capability Map

### 2.1 Tri thuc (Knowledge)
- **UML Standards**: Hi·ªÉu s√¢u v·ªÅ Lifelines, Synchronous/Asynchronous Messages, v√† c√°c Fragments (`alt`, `opt`, `loop`, `ref`).
- **Mermaid Specialist**: Th√†nh th·∫°o c√∫ ph√°p Mermaid m√£ ngu·ªìn m·ªü ƒë·ªÉ sinh s∆° ƒë·ªì ch·∫•t l∆∞·ª£ng cao.
- **Domain Context**: Kh·∫£ nƒÉng ƒë·ªçc hi·ªÉu ki·∫øn tr√∫c d·ª± √°n (React/Next.js frontend & PayloadCMS backend).

### 2.2 Quy trinh (Process)
1.  **Scenario Discovery**: Ph√¢n t√≠ch k·ªãch b·∫£n t·ª´ input ng∆∞·ªùi d√πng v√† t√†i li·ªáu `context1.md`.
2.  **Codebase Research**: Qu√©t codebase ƒë·ªÉ x√°c ƒë·ªãnh ch√≠nh x√°c c√°c l·ªõp/h√†m tham gia v√†o lu·ªìng.
3.  **Traceability Analysis**: X√¢y d·ª±ng chu·ªói t∆∞∆°ng t√°c (ch·ªâ r√µ ai g·ªçi ai, tham s·ªë l√† g√¨).
4.  **Drafting & Refinement**: Sinh code Mermaid v√† t·ªëi ∆∞u h√≥a v·ªã tr√≠ c√°c lifelines b·∫£n v·∫Ω.
5.  **Quality Assurance**: Ki·ªÉm tra ch√©o v·ªõi Checklist tr∆∞·ªõc khi b√†n giao.

### 2.3 Kiem soat (Guardrails)
- **Code-First Truth**: Ch·ªâ v·∫Ω nh·ªØng g√¨ th·ª±c s·ª± t·ªìn t·∫°i ho·∫∑c ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a trong y√™u c·∫ßu thi·∫øt k·∫ø.
- **Readability Limit**: C·∫£nh b√°o ng∆∞·ªùi d√πng n·∫øu s∆° ƒë·ªì v∆∞·ª£t qu√° m·ª©c ƒë·ªô ph·ª©c t·∫°p cho ph√©p (qu√° nhi·ªÅu lifelines ho·∫∑c nested fragments).
- **Naming Consistency**: ƒê·∫£m b·∫£o t√™n Actor/Object kh·ªõp 100% v·ªõi codebase.

## 3. Zone Mapping

| Zone | Noi dung | Bat buoc? |
|------|----------|----------|
| Core (SKILL.md) | `SKILL.md`: ƒêi·ªÅu ph·ªëi 5 pha: Collect, Research, Design, Generate, Verify. | ‚úÖ |
| Knowledge | Ch·ª©a `knowledge/uml-rules.md`, `knowledge/project-patterns.md`, v√† `knowledge/sequence-preparation.md`. | ‚úÖ |
| Scripts | (Optional) script ph√¢n t√≠ch call stack ƒë∆°n gi·∫£n. | ‚ùå |
| Templates | M·∫´u Mermaid: `templates/crud-flow.mmd`, `templates/auth-flow.mmd`, `templates/logic-flow.mmd`. | ‚úÖ |
| Data | C·∫•u h√¨nh theme/styling cho s∆° ƒë·ªì. | ‚ùå |
| Loop | `loop/checklist.md`, `loop/verify-script.py`, v√† `loop/test-cases/index.md`. | ‚úÖ |
| Assets | N/A | ‚ùå |

## 4. Folder Structure

```mermaid
mindmap
  root((sequence-design-analyst))
    SKILL.md
      Persona: Senior UML Architect
      Phases: Scenario, Research, Design, Verify
    knowledge
      uml-rules.md
      project-patterns.md
      sequence-preparation.md
    templates
      crud-flow.mmd
      auth-flow.mmd
      logic-flow.mmd
    loop
      checklist.md
      verify-script.py
      test-cases/index.md
```

## 5. Execution Flow

```mermaid
sequenceDiagram
    participant U as Steve (User)
    participant A as Analyst Skill
    participant C as Codebase
    participant K as Knowledge Zone
    participant L as Loop Zone

    U->>A: Input Scenario / Requirements
    A->>A: Read SKILL.md & context1.md
    A->>C: Search for actual logic (grep/view_file)
    A->>K: Reference UML & Project standards
    A->>A: Construct Message Objects
    A->>L: Verify against checklist.md
    alt Is Valid
        A->>U: Final Mermaid Code + Context Summary
    else Missing Info
        A-->>U: Request Clarification (Interaction Point)
    end
```

## 6. Interaction Points

| # | Thoi diem | Ly do |
|---|-----------|-------|
| 1 | Sau khi Scenario Discovery | X√°c nh·∫≠n k·ªãch b·∫£n (Scenario) v√† danh s√°ch Actor/Lifelines ch√≠nh x√°c. |
| 2 | Sau khi Codebase Research | X√°c nh·∫≠n lu·ªìng c√°c ph∆∞∆°ng th·ª©c (Method calls) ƒë√£ ƒë√∫ng v·ªõi th·ª±c t·∫ø codebase. |
| 3 | Tr∆∞·ªõc khi Generate Final | X√°c nh·∫≠n ph∆∞∆°ng √°n x·ª≠ l√Ω c√°c nh√°nh `alt` ph·ª©c t·∫°p. |

## 7. Progressive Disclosure Plan

### Tang 1: Bat buoc doc (Mandatory)
- `SKILL.md`: Linh h·ªìn ƒëi·ªÅu h∆∞·ªõng Agent.
- `knowledge/uml-rules.md`: B·ªô quy t·∫Øc v·∫Ω chu·∫©n.
- `loop/checklist.md`: R√†o ch·∫Øn ch·∫•t l∆∞·ª£ng.

### Tang 2: Tu quyet dinh (Conditional)
- `knowledge/project-patterns.md`: ƒê·ªçc khi c·∫ßn hi·ªÉu c√°ch g·ªçi Local API c·ªßa d·ª± √°n.
- `templates/*.mmd`: S·ª≠ d·ª•ng khi sinh output c·ª• th·ªÉ.
- `loop/verify-script.py`: Ch·∫°y khi c·∫ßn th·∫©m ƒë·ªãnh logic ph·ª©c t·∫°p.

## 8. Risks & Blind Spots

<!-- AI thuong sai o dau voi loai cong viec nay? Co rui ro gi? -->

| # | Risk | Mitigation |
|---|------|------------|
| 1 | AI v·∫Ω sai logic th·ª±c t·∫ø do codebase ph·ª©c t·∫°p. | B·∫Øt bu·ªôc AI ph·∫£i d√πng `grep/view_file` tr∆∞·ªõc khi v·∫Ω. |
| 2 | S∆° ƒë·ªì Mermaid qu√° d√†i g√¢y l·ªói render ho·∫∑c kh√≥ ƒë·ªçc. | Quy t·∫Øc chia nh·ªè s∆° ƒë·ªì (Sub-sequences) n·∫øu lifelines > 8. |
| 3 | Thi·∫øu c√°c tr∆∞·ªùng h·ª£p ngo·∫°i l·ªá (Edge cases). | Checklist b·∫Øt bu·ªôc ph·∫£i c√≥ √≠t nh·∫•t 1 block `alt` cho lu·ªìng l·ªói. |

## 9. Open Questions

| # | Cau hoi | Trang thai |
|---|---------|-----------|
| 1 | C√≥ c·∫ßn b·ªï sung script t·ª± ƒë·ªông export ·∫£nh t·ª´ Mermaid kh√¥ng? | ‚ùå Kh√¥ng c·∫ßn |
| 2 | Skill c√≥ n√™n ki√™m lu√¥n vi·ªác g·ª£i √Ω Refactor code sau khi v·∫Ω kh√¥ng? | ‚ùå Kh√¥ng c·∫ßn |

## 10. Metadata

- **Skill Name**: sequence-design-analyst
- **Created**: 2026-02-17
- **Author**: Skill Architect (T√≠t d·ªÖ th∆∞∆°ng üå∏)
- **Framework**: architect.md v2.0
- **Status**: üöÄ APPROVED (Ready for Planning)
