# Discovery & Feed - Schema Design

> Data Architect Schema cho PayloadCMS/MongoDB từ Contract `Docs/life-2/diagrams/class-diagrams/m3-discovery-feed/class-m3-discovery-feed.yaml`.

## 1. Module Overview
- **Mã hệ thống**: `M3`
- **Mô tả ngắn**: Quản lý truy vấn bảng tin (Feed query), phân phối nội dung và sắp xếp bài viết dựa trên thuật toán.
- **Special Note**: Module M3 KHÔNG có Payload collections vật lý. `feedQuery` là một ValueObject đại diện cho DTO API query parameters khi lấy feed để tránh tạo collection thừa trên DB.

## 2. Database Design (Collections)

### 2.1 Object: `feedQuery`
- **Type**: `ValueObject (No Collection)`
- **Reason**: Logic lấy bảng tin (chronological, ranked, discover) chỉ phụ thuộc vào các parameters truyền vào và không cần thiết phải lưu lại toàn bộ feed-query-states. Các tham số này sẽ map thẳng vào MongoDB Aggregation Pipeline hoặc Find Queries của Payload API.
- **Fields List**:
| Field Name | Payload Type | Mongo Entity | Index? | Mô tả / Range | Note |
|------------|--------------|--------------|--------|---------------|------|
| `userId` | `text` | N/A | `false` | ID người dùng | Truy vấn |
| `followingIds` | `array` | N/A | `false` | List IDs người mình follow | Load từ Connections |
| `feedType` | `select` | N/A | `false` | Loại feed | chronological, ranked, discover |
| `sortStrategy`| `select` | N/A | `false` | Thuật toán xếp | createdAt_desc, rankingScore_desc, mixed |
| `page` | `number` | N/A | `false` | Trang số | Default: 1 |
| `limit` | `number` | N/A | `false` | Số lượng bài | Default: 20 |
| `statusFilter` | `array` | N/A | `false` | Lọc status | Default: ['published'] |
| `visibilityFilter`| `array`| N/A | `false` | Lọc quyền xem | Derived from connections |
| `cursorTimestamp` | `date` | N/A | `false` | Trỏ cursor pagination | |

---
*Generated by schema-design-analyst AI Agent.*
